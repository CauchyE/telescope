<ng-container *ngIf="coins === null; then loading; else loaded"></ng-container>
<ng-template #loading>
  <mat-progress-spinner
    [diameter]="60"
    [mode]="'indeterminate'"
  ></mat-progress-spinner>
</ng-template>
<ng-template #loaded>
  <ng-container
    *ngIf="coins?.length || 0 > 0; then exist; else empty"
  ></ng-container>
</ng-template>
<ng-template #exist>
  <mat-list>
    <h3 matSubheader>Keys</h3>
    <mat-divider></mat-divider>
    <ng-container *ngFor="let coin of coins">
      <mat-list-item>
        <span>{{ coin?.denom }}</span>
        <span fxFlex="auto"> </span>
        <span>{{ coin?.amount }}</span>
      </mat-list-item>
      <mat-divider></mat-divider>
    </ng-container>
  </mat-list>

  <form
    #formRef="ngForm"
    (submit)="onSubmit(toAddressRef.value, privateKeyRef.value)"
  >
    <mat-form-field fxFill>
      <mat-label>To address</mat-label>
      <input #toAddressRef ngModel name="to-address" matInput required />
    </mat-form-field>

    <ng-container *ngFor="let e of amount; let i = index">
      <div fxLayout="row" fxLayoutAlign="initial center">
        <mat-form-field fxFlex="auto">
          <mat-label>Denom</mat-label>
          <input [(ngModel)]="amount[i].denom" name="denom-{{ i }}" matInput />
        </mat-form-field>
        <mat-form-field fxFlex="auto">
          <mat-label>Amount</mat-label>
          <input
            [(ngModel)]="amount[i].amount"
            name="amount-{{ i }}"
            matInput
            type="number"
            pattern="^\d+$"
            [min]="0"
          />
        </mat-form-field>
        <button
          mat-icon-button
          color="warn"
          [disabled]="amount.length <= 1"
          (click)="removeAmount(i)"
        >
          <mat-icon>close</mat-icon>
        </button>
      </div>
    </ng-container>
    <button mat-button fxFill color="accent" (click)="addAmount()">
      <mat-icon>add</mat-icon>
      <span>Add</span>
    </button>
    <mat-checkbox required>Confirm</mat-checkbox>

    <mat-form-field fxFill>
      <mat-label>ID</mat-label>
      <input #idRef [ngModel]="key?.id" name="id" matInput readonly />
    </mat-form-field>
    <mat-form-field fxFill>
      <mat-label>Private key</mat-label>
      <input #privateKeyRef ngModel name="password" matInput required />
    </mat-form-field>
    <button mat-flat-button [disabled]="formRef.invalid">Send</button>
  </form>
</ng-template>
<ng-template #empty>
  <p>Balance is empty</p>
</ng-template>
